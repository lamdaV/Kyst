"use strict";var _cliProgress=require("cli-progress"),progress=_interopRequireWildcard(_cliProgress),_KystClient=require("../dist/KystClient"),_KystClient2=_interopRequireDefault(_KystClient);function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _interopRequireWildcard(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}var findNKitties=function(a){var b=new _KystClient2.default,c=new progress.Bar({format:"searching... [{bar}] {percentage}% | {value} / {total} | {duration}s",stopOnComplete:!0});c.start(a,0);var d=function(a){return new Promise(function(b){return setTimeout(b,a)})},e=function(f,g,h){return f>=a?(c.update(a),Promise.resolve([])):(c.update(f),b.getMedianPriceUSD().then(function(a){return b.convertUSD2ETH(a).then(function(a){return b.getAuctions(g,h,"sale","open").then(function(b){return b.auctions.map(function(a){return a.eth=a.current_price*_KystClient.CONVERSION_FACTOR,a}).filter(function(b){return b.eth<=a}).map(function(a){return a.kitty}).filter(function(a){return 8>=a.generation}).map(function(a){return"https://www.cryptokitties.co/kitty"+"/"+a.id})}).catch(function(){return d(5e3).then(function(){return e(f,g,h)})}).then(function(a){var b=a.length;return e(f+b,g+h,h).then(function(b){return a.concat(b)})})})}))};return e(0,0,10)};findNKitties(10).then(function(a){console.log("\nFound Kitties: "),a.forEach(function(a){return console.log(a)})});
